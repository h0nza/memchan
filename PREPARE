# -*- tcl -*-
# prepare module MEMCHAN for distribution
# CVS:	$Id: PREPARE,v 1.12 1999/03/24 12:27:26 aku Exp $


# O. insert various information into some files
#    (version, patchlevel, current date)

mExclude LSM ANNOUNCE

mInsertInfo \
	DESCRIPTION doc/manual \
	README win/README win/README.VC mac/README \
	unix/configure.in unix/Makefile.in \
	win/makefile.vc win/mc.rc

mGetDescription
mExpandUrls
mGenerateLSM
mGenerateANNOUNCE


#file copy unix/pkgIndex.tcl.in win/pkgIndex.tcl

set mInfo(@configure_input@)  "Distributed at $mDate"
set mInfo(@MEMCHAN_VERSION@)  $mVersion
#set mInfo(@MC_USING_STUBS@)   1 ; # implicit usage on Win*
set mInfo(@MEMCHAN_LIB_FILE@) mchan${mShortDosVersion} ; # .dll added by index file itself
#                             ~~~~~ coordinate with win/makefile.vc
mInsertInfo win/pkgIndex.tcl

# remove internal directories

mExclude patches mails

# generate configure script to be used
mConfigure unix

# Integrate tk-based testsuite interface.

exec makedist tg
exec tar xfz [glob tg*.tar.gz]
eval file delete \
	[glob tg*.README] [glob tg*.ANNOUNCE] \
	[glob tg*.LSM] [glob tg*.tar.gz] \
	[glob tg*.DESCRIPTION]

eval file rename [glob tg*] testlib

